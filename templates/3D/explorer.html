<html>
    <head>
    <title>DIMCREATOR</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="/static/back/js/explorer-three.js"></script>
    <script src="/static/back/js/Detector.js"></script>
    <script src="/static/back/js/OrbitControls.js"></script>
    <script src="/static/back/js/OBJLoader.js"></script>
    <script src="/static/back/js/MTLLoader.js"></script>


    <style>
            body {
                overflow: hidden;
                margin: 0;
                padding: 0;
                background: hsl(0, 0%, 10%);
            }
    
            p {
                margin: 0;
                padding: 0;
            }
    
    </style>
    </head>
    <body>
        <script>
    
            if (!Detector.webgl) {
                Detector.addGetWebGLMessage();
            }
    
            var container;
    
            var camera, controls, scene, renderer;
            var lighting, ambient, keyLight, fillLight, backLight;
    
            var windowHalfX = window.innerWidth / 2;
            var windowHalfY = window.innerHeight / 2;

            init();
            animate();
    
            function init() {
    
                container = document.createElement('div');
                document.body.appendChild(container);
    
                /* Camera */
    
                camera = new THREE.PerspectiveCamera(50, window.innerWidth / window.innerHeight, 1, 10000);
                
                // Place camera on x axis
                //camera.position.set(30,0,0);
                //camera.up = new THREE.Vector3(0,0,1);
                camera.lookAt(new THREE.Vector3( {{cox}} , {{coy}} , {{coz}}));
                
                // Place camera on y axis
                camera.position.set({{cax}},{{cay}},{{caz}});
                camera.up = new THREE.Vector3(0,1,0);
    
                /* Scene */
    
                scene = new THREE.Scene();
                lighting = true;
                
                ambient = new THREE.AmbientLight(0xffffff, 1.0);
                scene.add(ambient);
    
                keyLight = new THREE.DirectionalLight(new THREE.Color('hsl(0, 0, 100%)'), 0.4);
                keyLight.position.set(-100, 100, 100);
    
                fillLight = new THREE.DirectionalLight(new THREE.Color('hsl(0, 0, 100%)'), 0.4);
                fillLight.position.set(100, 100, 100);
    
                backLight = new THREE.DirectionalLight(0xffffff, 1.0);
                backLight.position.set(100, 0, -100).normalize();

                /*LightHelper*/
                /*
                var keyLightHelper = new THREE.DirectionalLightHelper( keyLight );
                scene.add( keyLightHelper );555
    
                var fillLightHelper = new THREE.DirectionalLightHelper( fillLight );
                scene.add( fillLightHelper );

                var backLightHelper = new THREE.DirectionalLightHelper( backLight );
                scene.add( backLightHelper );
                */
                
                /* Model */
    
                /*var mtlLoader = new THREE.MTLLoader();
                mtlLoader.setBaseUrl('../media/Warehouse/{{workid}}/');
                mtlLoader.setPath('../media/Warehouse/{{workid}}/');
                mtlLoader.load('mtl.mtl', function (materials) {
    
                    materials.preload();

    
                });*/
    
                var objLoader = new THREE.OBJLoader();
                   /* objLoader.setMaterials(materials);*/
                    objLoader.setPath('../media/Warehouse/{{workid}}/');
                    objLoader.load('obj.obj', function (object) {
    
                        scene.add(object);
    
                    });    
                /* Renderer */
    
                renderer = new THREE.WebGLRenderer();
                renderer.setPixelRatio(window.devicePixelRatio);
                renderer.setSize(window.innerWidth, window.innerHeight);
                renderer.setClearColor(new THREE.Color("hsl(0, 0%, 10%)"));
    
                container.appendChild(renderer.domElement);
    
                /* Controls 
                var cox = Number({{cox}});
                var coy = Number({{coy}});
                var coz = Number({{coz}});*/
    
                var target = new THREE.Vector3( {{cox}} , {{coy}} , {{coz}} );
                controls = new THREE.OrbitControls(camera, renderer.domElement, target);
                controls.enableDamping = true;
                controls.dampingFactor = 0.25;
                controls.enableZoom = true;
    
                /* Events */
    
                window.addEventListener('resize', onWindowResize, false);
    
            }
    
            function onWindowResize() {
    
                windowHalfX = window.innerWidth / 2;
                windowHalfY = window.innerHeight / 2;
    
                camera.aspect = window.innerWidth / window.innerHeight;
                camera.updateProjectionMatrix();
    
                renderer.setSize(window.innerWidth, window.innerHeight);
    
            }

            ambient.intensity = 0.25;
            scene.add(keyLight);
            scene.add(fillLight);
            scene.add(backLight);
    
            function animate() {
    
                requestAnimationFrame(animate);
    
                controls.update();
    
                render();
    
            }
    
            function render() {
    
                renderer.render(scene, camera);
    
            }
    
        </script>
    
    
    </body>
</html>